{"version":3,"sources":["../../lib/assets/javascripts/os-time.js","../../lib/assets/javascripts/os-shared.js","../../lib/assets/javascripts/os-notifications.js","../../lib/assets/javascripts/os-actions.js","../../lib/assets/javascripts/main_front.js","../../lib/assets/javascripts/os-payments-braintree.js","../../lib/assets/javascripts/os-payments-paypal.js"],"names":["latepoint_is_timeframe_in_periods","timeframe_start","timeframe_end","periods_arr","is_inside","arguments","length","undefined","i","period_start","period_end","buffer_before","buffer_after","period_info","split","parseFloat","latepoint_is_period_inside_another","latepoint_is_period_overlapping","period_one_start","period_one_end","period_two_start","period_two_end","latepoint_minutes_to_hours_preferably","time","army_clock","latepoint_is_army_clock","hours","Math","floor","minutes","latepoint_minutes_to_hours","latepoint_am_or_pm","latepoint_hours_and_minutes_to_minutes","hours_and_minutes","ampm","hours_and_minutes_arr","parseInt","latepoint_get_time_system","latepoint_helper","time_system","latepoint_minutes_to_hours_and_minutes","format","sprintf","latepoint_mask_timefield","$elem","jQuery","inputmask","mask","placeholder","latepoint_mask_phone","latepoint_is_phone_masking_enabled","latepoint_get_phone_format","phone_format","enable_phone_masking","latepoint_show_booking_end_time","show_booking_end_time","latepoint_init_form_masks","latepoint_get_paypal_payment_amount","$booking_form_wrapper","payment_portion","payment_amount","find","val","data","latepoint_add_notification","message","message_type","wrapper","append","remove","latepoint_generate_form_message_html","messages","status","message_html","Array","isArray","forEach","latepoint_clear_form_messages","$form","latepoint_show_data_in_lightbox","extra_classes","lightbox_css_classes","addClass","show_next_btn","removeClass","clear_service_sub_values","$item","closest","latepoint_update_summary_field","hide_next_btn","show_prev_btn","hide_prev_btn","latepoint_show_capacity_selector","max_capacity","text","latepoint_show_durations","latepoint_apply_coupon","$coupon_input","form_params","serialize","action","route_name","params","layout","return_format","ajax","type","dataType","url","ajaxurl","success","latepoint_show_message_inside_element","latepoint_reload_step","latepoint_coupon_removed","fadeOut","submit","latepoint_get_new_prev_payment_class","$payment_step","new_current_payment_step_class","new_prev_payment_step_class","latepoint_reset_password_from_booking_init","hide","on","html","show","field_name","value","$summary_holder","String","trim","hasClass","slideDown","fadeIn","slideUp","latepoint_password_changed_show_login","response","latepoint_hide_message_inside_element","prepend","latepoint_clear_step_vars","step_name","latepoint_set_payment_token_and_submit","token","$booking_form","document","ready","$","e","$this","this","confirm","location","reload","window","replace","before","after","func_name","alert","preventDefault","form_data","record_id","form_values_to_update","each","name","documentElement","body","animate","scrollTop","offset","top","OsPaymentsBraintree","button","braintree","client","create","authorization","braintree_paypal_client_auth","then","clientInstance","paypalCheckout","paypalCheckoutInstance","paypal","Button","render","style","label","size","shape","tagline","color","env","braintree_paypal_environment_name","payment","createPayment","flow","amount","currency","paypal_payment_currency","intent","onAuthorize","actions","tokenizePayment","payload","nonce","onCancel","onError","err","console","error","catch","zip","additionalData","hostedFieldsInstance","tokenize","tokenizeErr","code","details","invalidFields","key","field","braintree_tokenization_key","hostedFields","styles","input","font-size","font-family","body_font_family","font-weight",":focus","::placeholder",".valid",".invalid","fields","number","selector","cvv","expirationDate","OsPaymentsPaypal","Buttons","createOrder","order","purchase_units","currency_code","application_context","shipping_preference","onApprove","authorize","authorizationID","payments","authorizations","id","orderID","latepoint_register_stripe_card_elements","elements","element","event","latepoint_stripe_create_token","address_zip","latepoint_stripe","createToken","latepoint_stripe_elements_card_number","result","latepoint_init_stripe_form","Stripe","stripe_key","latepoint_stripe_elements","elementStyles","base","fontFamily","fontSize","fontWeight","elementClasses","focus","empty","invalid","classes","mount","latepoint_stripe_elements_card_expiry","latepoint_stripe_elements_card_cvc","latepoint_init_step","latepoint_init_step_selectable_items","latepoint_init_step_items_with_price","latepoint_init_step_datepicker","latepoint_init_step_contact","latepoint_init_step_agents","latepoint_init_step_services","latepoint_init_step_payment","latepoint_init_step_verify","latepoint_init_step_confirmation","day_timeslots","$day","service_duration","interval","work_start_minutes","work_end_minutes","total_work_minutes","available_minutes","toString","map","Number","day_minutes","$timeslots","prev_minutes","current_minutes","off_label","off_width","timeslot_class","includes","tick_html","timeslot_label","end_minutes","end_minutes_ampm","msg_not_available","os_init_timeslots","selected_timeslot_time","os_init_monthly_calendar_navigation","next_month_route_name","next","latepoint_calendar_set_month_label","$btn","$calendar_element","last","calendar_year","calendar_month","booking_info","target_date_string","location_id","agent_id","service_id","duration","total_attendies","latepoint_calendar_show_or_hide_prev_next_buttons","prev","$scrollable_wrapper","stop","scrollHeight","latepoint_init_paypal_button","$booking_form_element","is_braintree_paypal_active","create_paypal_button","is_paypal_native_active","latepoint_init_cc_form","is_braintree_active","init_cc_form","is_stripe_active","latepoint_format_price","which","current_payment_step_class","portion","off","latepoint_selectable_item_clicked","latepoint_priced_item_clicked","operator","latepoint_update_booking_component_price","latepoint_calculate_total_price","total_price","toFixed","item_type","item_type_class","price","summary_value","toggleClass","ids","get","trigger_next_or_show_next_button","currency_symbol_before","currency_symbol_after","add_value","current_value","new_value","max","min","trigger","$category_wrapper","$main_parent","parent","manual_next_step","latepoint_init_step_locations","account_nonse","password","password_confirmation","param","latepoint_init_customer_dashboard_login","$login_form_wrapper","FB","login","authResponse","accessToken","latepoint_step_content_change_start","latepoint_step_content_change_end","scope","googleUser","$login_form_wrappers","gapi","load","auth2","init","client_id","attr","cookiepolicy","attachClickHandler","getAuthResponse","id_token","latepoint_init_facebook_login","latepoint_init_google_login","customer_name","latepoint_validate_fields","email","new_content","replaceWith","setTimeout","$booking_form_wrappers","latepoint_change_step_desc","$step_progress","prevAll","nextAll","side_panel_desc","top_header_desc","latepoint_progress_prev","latepoint_progress_next","latepoint_next_step_description","latepoint_prev_step_description","$fields","is_valid","index","latepoint_init_booking_form","$select_box","timezone_name","is_timezone_selected","tzid","Intl","DateTimeFormat","resolvedOptions","timeZone","change","className","match","join","is_pre_last_step","is_last_step","css","demo_mode","create_token","current_step","$services_step","parents","cancel_booking_prompt","$booking_box","route","target","$tabs_wrapper","booking_button_route","restrictions","show_service_categories","show_locations","show_services","show_agents","selected_location","selected_agent","selected_service","selected_service_category","calendar_start_date","isEmptyObject","lightbox_class","step"],"mappings":"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","sourcesContent":["function latepoint_is_timeframe_in_periods(timeframe_start, timeframe_end, periods_arr) {\n  var is_inside = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n\n  for (var i = 0; i < periods_arr.length; i++) {\n\n    var period_start = 0;\n    var period_end = 0;\n    var buffer_before = 0;\n    var buffer_after = 0;\n\n    var period_info = periods_arr[i].split(':');\n    if (period_info.length == 2) {\n      period_start = period_info[0];\n      period_end = period_info[1];\n    } else {\n      buffer_before = period_info[2];\n      buffer_after = period_info[3];\n      period_start = parseFloat(period_info[0]) - parseFloat(buffer_before);\n      period_end = parseFloat(period_info[1]) + parseFloat(buffer_after);\n    }\n    if (is_inside) {\n      if (latepoint_is_period_inside_another(timeframe_start, timeframe_end, period_start, period_end)) {\n        return true;\n      }\n    } else {\n      if (latepoint_is_period_overlapping(timeframe_start, timeframe_end, period_start, period_end)) {\n        return true;\n      }\n    }\n  };\n  return false;\n}\n\nfunction latepoint_is_period_overlapping(period_one_start, period_one_end, period_two_start, period_two_end) {\n  // https://stackoverflow.com/questions/325933/determine-whether-two-date-ranges-overlap/\n  return period_one_start < period_two_end && period_two_start < period_one_end;\n}\nfunction latepoint_is_period_inside_another(period_one_start, period_one_end, period_two_start, period_two_end) {\n  return period_one_start >= period_two_start && period_one_end <= period_two_end;\n}\n\n\n// Converts time in minutes to hours if possible, if minutes also exists - shows minutes too\nfunction latepoint_minutes_to_hours_preferably(time) {\n  var army_clock = latepoint_is_army_clock();\n\n  var hours = Math.floor(time / 60);\n  if (!army_clock && hours > 12) hours = hours - 12;\n\n  var minutes = time % 60;\n  if(minutes > 0) hours = hours + ':' + minutes;\n  return hours;\n}\n\n\nfunction latepoint_minutes_to_hours(time) {\n  var army_clock = latepoint_is_army_clock();\n\n  var hours = Math.floor(time / 60);\n  if (!army_clock && hours > 12) hours = hours - 12;\n  return hours;\n}\n\n\nfunction latepoint_am_or_pm(minutes) {\n  if(latepoint_is_army_clock()) return '';\n  return (minutes < 720) ? 'am' : 'pm';\n}\n\nfunction latepoint_hours_and_minutes_to_minutes(hours_and_minutes, ampm) {\n  var hours_and_minutes_arr = hours_and_minutes.split(':');\n  var hours = hours_and_minutes_arr[0];\n  var minutes = hours_and_minutes_arr[1];\n  if(ampm == \"pm\" && hours<12) hours = parseInt(hours)+12;\n  if(ampm == \"am\" && hours==12) hours = 0;\n  minutes = parseInt(minutes) + (hours * 60);\n  return minutes;\n}\n\nfunction latepoint_get_time_system(){\n  return latepoint_helper.time_system;\n}\n\nfunction latepoint_is_army_clock(){\n  return (latepoint_get_time_system() == '24');\n}\n\nfunction latepoint_minutes_to_hours_and_minutes(time) {\n  var army_clock = latepoint_is_army_clock();\n  var format = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '%02d:%02d';\n\n  var hours = Math.floor(time / 60);\n  if(!army_clock && (hours > 12)) hours = hours - 12;\n  var minutes = time % 60;\n  return sprintf(format, hours, minutes);\n}\n","function latepoint_mask_timefield($elem){\n\tif(jQuery().inputmask){\n\t  $elem.inputmask({\n\t      'mask': '99:99',\n\t      'placeholder': 'HH:MM'\n\t  });\n\t}\n}\n\nfunction latepoint_mask_phone($elem){\n\tif(latepoint_is_phone_masking_enabled() && jQuery().inputmask) $elem.inputmask(latepoint_get_phone_format());\n}\n\n\nfunction latepoint_get_phone_format(){\n  return latepoint_helper.phone_format;\n}\n\nfunction latepoint_is_phone_masking_enabled(){\n\treturn (latepoint_helper.enable_phone_masking == 'yes');\n}\n\nfunction latepoint_show_booking_end_time(){\n\treturn (latepoint_helper.show_booking_end_time == 'yes');\n}\n\nfunction latepoint_init_form_masks(){\n\tif(latepoint_is_phone_masking_enabled()) latepoint_mask_phone(jQuery('.os-mask-phone'));\n}\n\nfunction latepoint_get_paypal_payment_amount($booking_form_wrapper){\n\tvar payment_portion = $booking_form_wrapper.find('input[name=\"booking[payment_portion]\"]').val();\n\tvar payment_amount = (payment_portion == 'deposit') ? $booking_form_wrapper.find('.lp-paypal-btn-trigger').data('deposit-amount') : $booking_form_wrapper.find('.lp-paypal-btn-trigger').data('full-amount');\n\treturn payment_amount;\n}","function latepoint_add_notification(message, message_type = 'success'){\n\tvar wrapper = jQuery('body').find('.os-notifications');\n\tif(!wrapper.length){\n\t\tjQuery('body').append('<div class=\"os-notifications\"></div>');\n\t\twrapper = jQuery('body').find('.os-notifications');\n\t}\n\tif(wrapper.find('.item').length > 0) wrapper.find('.item:first-child').remove();\n\twrapper.append('<div class=\"item item-type-'+ message_type +'\">' + message + '<span class=\"os-notification-close\"><i class=\"latepoint-icon latepoint-icon-x\"></i></span></div>');\n}","function latepoint_generate_form_message_html(messages, status){\n  var message_html = '<div class=\"os-form-message-w status-' + status + '\"><ul>';\n  if(Array.isArray(messages)){\n    messages.forEach(function(message){\n      message_html+= '<li>' + message + '</li>';\n    });\n  }else{\n    message_html+= '<li>' + messages + '</li>';\n  }\n  message_html+= '</ul></div>';\n  return message_html;\n}\n\nfunction latepoint_clear_form_messages($form){\n  $form.find('.os-form-message-w').remove();\n}\n\nfunction latepoint_show_data_in_lightbox(message, extra_classes = ''){\n  jQuery('.latepoint-lightbox-w').remove();\n  var lightbox_css_classes = 'latepoint-lightbox-w latepoint-w ';\n  if(extra_classes) lightbox_css_classes+= extra_classes;\n  jQuery('body').append('<div class=\"'+ lightbox_css_classes +'\"><div class=\"latepoint-lightbox-i\">' + message + '<a href=\"#\" class=\"latepoint-lightbox-close\"><i class=\"latepoint-icon latepoint-icon-x\"></i></a></div><div class=\"latepoint-lightbox-shadow\"></div></div>');\n  jQuery('body').addClass('latepoint-lightbox-active');\n}\n\n\n\n// DOCUMENT READY\njQuery(document).ready(function( $ ) {\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  /* \n    Ajax buttons action\n  */\n  $('.latepoint').on('click', 'button[data-os-action], a[data-os-action], div[data-os-action], span[data-os-action]', function(e){\n    var $this = $(this);\n    if($this.data('os-prompt') && !confirm($this.data('os-prompt'))) return false;\n    var params = $(this).data('os-params');\n    if($(this).data('os-source-of-params')){\n      params = $($(this).data('os-source-of-params')).find('select, input, textarea').serialize();\n    }\n    var return_format = $this.data('os-return-format') ? $this.data('os-return-format') : 'json'\n    var data = { action: 'latepoint_route_call', route_name: $(this).data('os-action'), params: params, return_format: return_format } \n    $this.addClass('os-loading');\n    $.ajax({\n      type : \"post\",\n      dataType : \"json\",\n      url : latepoint_helper.ajaxurl,\n      data : data,\n      success: function(response){\n        if(response.status === \"success\"){\n          if($this.data('os-output-target') == 'lightbox'){\n            latepoint_show_data_in_lightbox(response.message, $this.data('os-lightbox-classes'));\n          }else if($this.data('os-output-target') == 'side-panel'){\n            $('.latepoint-side-panel-w').remove();\n            $('body').append('<div class=\"latepoint-side-panel-w\"><div class=\"latepoint-side-panel-i\">' + response.message + '</div><div class=\"latepoint-side-panel-shadow\"></div></div>');\n          }else if($this.data('os-success-action') == 'reload'){\n            latepoint_add_notification(response.message);\n            location.reload();\n            return;\n          }else if($this.data('os-success-action') == 'redirect'){\n            if($this.data('os-redirect-to')){\n              latepoint_add_notification(response.message);\n              window.location.replace($this.data('os-redirect-to'));\n            }else{\n              window.location.replace(response.message); \n            }\n            return;\n          }else if($this.data('os-output-target') && $($this.data('os-output-target')).length){\n            if($this.data('os-output-target-do') == 'append'){\n              $($this.data('os-output-target')).append(response.message);\n            }else{\n              $($this.data('os-output-target')).html(response.message);\n            }\n          }else{\n            if($this.data('os-before-after') == 'before'){\n              $this.before(response.message);\n            }else if($this.data('os-before-after') == 'before'){\n              $this.after(response.message);\n            }else{\n              latepoint_add_notification(response.message);\n            }\n          }\n          if($this.data('os-after-call')){\n            var func_name = $this.data('os-after-call');\n            if($this.data('os-pass-this')){\n              window[func_name]($this);\n            }else if($this.data('os-pass-response')){\n              window[func_name](response);\n            }else{\n              window[func_name]();\n            }\n          }\n          $this.removeClass('os-loading');\n        }else{\n          $this.removeClass('os-loading');\n          if($this.data('os-output-target') && $($this.data('os-output-target')).length){\n            $($this.data('os-output-target')).prepend(latepoint_generate_form_message_html(response.message, 'error'));\n          }else{\n            alert(response.message);\n          }\n        }\n      }\n    });\n    return false;\n  });\n\n\n  $('.latepoint').on('click', 'form[data-os-action] button[type=\"submit\"]', function(e){\n    $(this).addClass('os-loading');\n  });\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  /* \n    Form ajax submit action\n  */\n  $('.latepoint').on('submit', 'form[data-os-action]', function(e){\n    e.preventDefault(); // prevent native submit\n    var $form = $(this);\n    var form_data = $form.serialize();\n    var data = { action: 'latepoint_route_call', route_name: $(this).data('os-action'), params: form_data, return_format: 'json' }\n    $form.find('button[type=\"submit\"]').addClass('os-loading');\n    $.ajax({\n      type : \"post\",\n      dataType : \"json\",\n      url : latepoint_helper.ajaxurl,\n      data : data,\n      success: function(response){\n        $form.find('button[type=\"submit\"].os-loading').removeClass('os-loading');\n        latepoint_clear_form_messages($form);\n        if(response.status === \"success\"){\n          if($form.data('os-success-action') == 'reload'){\n            latepoint_add_notification(response.message);\n            location.reload();\n            return;\n          }else if($form.data('os-success-action') == 'redirect'){\n            if($form.data('os-redirect-to')){\n              latepoint_add_notification(response.message);\n              window.location.replace($form.data('os-redirect-to'));\n            }else{\n              window.location.replace(response.message);\n            }\n            return;\n          }else if($form.data('os-output-target') && $($form.data('os-output-target')).length){\n            $($form.data('os-output-target')).html(response.message);\n          }else{\n            if(response.message == 'redirect'){\n              window.location.replace(response.url);\n            }else{\n              latepoint_add_notification(response.message);\n              $form.prepend(latepoint_generate_form_message_html(response.message, 'success'));\n            }\n          }\n          if($form.data('os-record-id-holder') && response.record_id){\n            $form.find('[name=\"' + $form.data('os-record-id-holder') + '\"]').val(response.record_id)\n          }\n          if($form.data('os-after-call')){\n            var func_name = $form.data('os-after-call');\n            if($form.data('os-pass-response')){\n              window[func_name](response);\n            }else{\n              window[func_name]();\n            }\n          }\n          if(response.form_values_to_update){\n            $.each(response.form_values_to_update, function(name, value){\n              $form.find('[name=\"'+ name +'\"]').val(value);\n            });\n          }\n          $('button.os-loading').removeClass('os-loading');\n        }else{\n          $('button.os-loading').removeClass('os-loading');\n          if($form.data('os-show-errors-as-notification')){\n            latepoint_add_notification(response.message, 'error');\n          }else{\n            $form.prepend(latepoint_generate_form_message_html(response.message, 'error'));\n            $([document.documentElement, document.body]).animate({\n                scrollTop: ($form.find(\".os-form-message-w\").offset().top - 30)\n            }, 200);\n          }\n        }\n      }\n    });\n    return false;\n  });\n});","// @codekit-prepend \"os-time.js\"\n// @codekit-prepend \"os-shared.js\"\n// @codekit-prepend \"os-notifications.js\";\n// @codekit-prepend \"os-actions.js\"\n// @codekit-prepend \"os-payments-braintree.js\"\n// @codekit-prepend \"os-payments-paypal.js\"\n\n\n  function show_next_btn($booking_form_wrapper){\n    $booking_form_wrapper.find('.latepoint-next-btn').removeClass('disabled');\n    $booking_form_wrapper.removeClass('hidden-buttons');\n  }\n\n  function clear_service_sub_values($item){\n    var $booking_form_wrapper = $item.closest('.latepoint-booking-form-element');\n    latepoint_update_summary_field($booking_form_wrapper, 'duration', '');\n    latepoint_update_summary_field($booking_form_wrapper, 'service-extras', '');\n    latepoint_update_summary_field($booking_form_wrapper, 'total-attendies', '');\n    $booking_form_wrapper.find('.latepoint_service_extras_price').val('');\n    $booking_form_wrapper.find('.latepoint_service_extras_ids').val('');\n    $booking_form_wrapper.find('.latepoint_duration').val('');\n    $booking_form_wrapper.find('.latepoint_total_attendies').val(1);\n    $booking_form_wrapper.find('.quantity-selector-input').val(1);\n  }\n\n\n  function hide_next_btn($booking_form_wrapper){\n    $booking_form_wrapper.find('.latepoint-next-btn').addClass('disabled');\n    if($booking_form_wrapper.find('.latepoint-prev-btn.disabled').length) $booking_form_wrapper.addClass('hidden-buttons');\n  }\n\n\n  function show_prev_btn($booking_form_wrapper){\n    $booking_form_wrapper.find('.latepoint-prev-btn').removeClass('disabled');\n    $booking_form_wrapper.removeClass('hidden-buttons');\n  }\n\n  function hide_prev_btn($booking_form_wrapper){\n    $booking_form_wrapper.find('.latepoint-prev-btn').addClass('disabled');\n    if($booking_form_wrapper.find('.latepoint-next-btn.disabled').length) $booking_form_wrapper.addClass('hidden-buttons');\n  }\n\n\nfunction latepoint_show_capacity_selector($item){\n  var $booking_form_wrapper = $item.closest('.latepoint-booking-form-element');\n  var max_capacity = $item.data('max-capacity');\n  $booking_form_wrapper.find('.sta-sub-label span').text(max_capacity);\n  $booking_form_wrapper.find('.step-services-w').removeClass('selecting-service-duration');\n  $booking_form_wrapper.find('.quantity-selector-w').data('max-capacity', max_capacity);\n  $item.closest('.step-services-w').addClass('selecting-total-attendies');\n  show_prev_btn($booking_form_wrapper);\n  show_next_btn($booking_form_wrapper);\n}\n\n\nfunction latepoint_show_durations($item){\n  var $booking_form_wrapper = $item.closest('.latepoint-booking-form-element');\n  $item.closest('.step-services-w').addClass('selecting-service-duration');\n  show_prev_btn($booking_form_wrapper);\n  hide_next_btn($booking_form_wrapper);\n}\n\nfunction latepoint_apply_coupon($elem){\n  var $booking_form_wrapper = $elem.closest('.latepoint-booking-form-element');\n\n  var $coupon_input = $elem;\n  $coupon_input.closest('.coupon-code-input-w').addClass('os-loading');\n  var form_params = $booking_form_wrapper.find('.latepoint-form').serialize();\n  var data = { action: 'latepoint_route_call', route_name: $elem.data('route'), params: form_params, layout: 'none', return_format: 'json' }\n  jQuery.ajax({\n    type : \"post\",\n    dataType : \"json\",\n    url : latepoint_helper.ajaxurl,\n    data : data,\n    success: function(data){\n      $coupon_input.closest('.coupon-code-input-w').removeClass('os-loading');\n      if(data.status === \"success\"){\n        latepoint_show_message_inside_element(data.message, $booking_form_wrapper.find('.latepoint-body'), 'success');\n        latepoint_reload_step($booking_form_wrapper);\n      }else{\n        latepoint_show_message_inside_element(data.message, $booking_form_wrapper.find('.latepoint-body'), 'error');\n      }\n    }\n  });\n}\n\nfunction latepoint_coupon_removed($elem){\n  $elem.closest('.applied-coupon-code').fadeOut();\n  var $booking_form_wrapper = $elem.closest('.latepoint-booking-form-element');\n  latepoint_reload_step($booking_form_wrapper);\n}\n\nfunction latepoint_reload_step($booking_form_wrapper){\n\n  $booking_form_wrapper.find('.latepoint_step_direction').val('specific');\n  $booking_form_wrapper.find('.latepoint-form').submit();\n\n  return false;\n}\n\n\nfunction latepoint_get_new_prev_payment_class($payment_step, new_current_payment_step_class){\n  var new_prev_payment_step_class = '';\n  switch(new_current_payment_step_class){\n    case 'lp-show-pay-times':\n      new_prev_payment_step_class = '';\n    break;\n    case 'lp-show-pay-methods':\n      if($payment_step.find('.lp-payment-times-w').length){\n        new_prev_payment_step_class = 'lp-show-pay-times';\n      }else{\n        new_prev_payment_step_class = latepoint_get_new_prev_payment_class($payment_step, 'lp-show-pay-times');\n      }\n    break;\n    case 'lp-show-pay-portion-selection':\n      if($payment_step.find('.lp-payment-methods-w').length){\n        new_prev_payment_step_class = 'lp-show-pay-methods';\n      }else{\n        new_prev_payment_step_class = latepoint_get_new_prev_payment_class($payment_step, 'lp-show-pay-methods');\n      }\n    break;\n    case 'lp-show-card':\n    case 'lp-show-paypal':\n      if($payment_step.find('.lp-payment-portion-selection-w').length){\n        new_prev_payment_step_class = 'lp-show-pay-portion-selection';\n      }else{\n        new_prev_payment_step_class = latepoint_get_new_prev_payment_class($payment_step, 'lp-show-pay-portion-selection');\n      }\n    break;\n  }\n  return new_prev_payment_step_class;\n}\n\n\nfunction latepoint_reset_password_from_booking_init(){\n  jQuery('.os-step-existing-customer-login-w').hide();\n  jQuery('.os-password-reset-form-holder').on('click', '.password-reset-back-to-login', function(){\n    jQuery('.os-password-reset-form-holder').html('');\n    jQuery('.os-step-existing-customer-login-w').show();\n    return false;\n  });\n}\n\nfunction latepoint_update_summary_field($form, field_name, value){\n  var $summary_holder = $form.closest('.latepoint-with-summary');\n  if(!$summary_holder.length) return;\n  value = String(value).trim();\n  if(value){\n    $form.find('.os-summary-value-'+field_name).text(value).closest('.os-summary-line').addClass('os-has-value');\n    if($summary_holder.hasClass('latepoint-summary-is-open')){\n      $form.find('.os-summary-line.os-has-value').slideDown(150);\n    }else{\n      $form.find('.os-summary-line.os-has-value').fadeIn(200);\n    }\n    $summary_holder.addClass('latepoint-summary-is-open');\n  }else{\n    $form.find('.os-summary-value-'+field_name).text('').closest('.os-summary-line').slideUp(150).removeClass('os-has-value');\n  }\n}\n\nfunction latepoint_password_changed_show_login(response){\n  jQuery('.os-step-existing-customer-login-w').show();\n  jQuery('.os-password-reset-form-holder').html('');\n  latepoint_show_message_inside_element(response.message, jQuery('.os-step-existing-customer-login-w'), 'success');\n}\n\nfunction latepoint_hide_message_inside_element($elem = jQuery('.latepoint-body')){\n  if($elem.length && $elem.find('.latepoint-message').length){\n    $elem.find('.latepoint-message').remove();\n  }\n}\n\nfunction latepoint_show_message_inside_element(message, $elem = jQuery('.latepoint-body'), message_type = 'error'){\n  if($elem.length){\n    if($elem.find('.latepoint-message').length){\n      $elem.find('.latepoint-message').removeClass('latepoint-message-success').removeClass('latepoint-message-error').addClass('latepoint-message-'+ message_type +'').html(message).show();\n    }else{\n      $elem.prepend('<div class=\"latepoint-message latepoint-message-'+ message_type +'\">' + message + '</div>');\n    }\n  }\n}\n\nfunction latepoint_clear_step_vars(step_name, $form){\n  switch(step_name) {\n    case 'locations':\n      $form.find('input[name=\"booking[start_date]\"]').val('');\n      break;\n    case 'services':\n      $form.find('input[name=\"booking[service_id]\"]').val('');\n      break;\n    case 'agents':\n      $form.find('input[name=\"booking[agent_id]\"]').val('');\n      break;\n    case 'datepicker':\n      $form.find('input[name=\"booking[start_date]\"]').val('');\n      $form.find('input[name=\"booking[start_time]\"]').val('');\n      break;\n  }\n}\n\nfunction latepoint_set_payment_token_and_submit($booking_form_wrapper, token){\n  $booking_form_wrapper.find('input[name=\"booking[payment_token]\"]').val(token);\n  var $booking_form = $booking_form_wrapper.find('.latepoint-form');\n  $booking_form.find('.latepoint_step_direction').val('next').submit();\n}\n\n( function( $ ) {\n  \"use strict\";\n\n  var latepoint_stripe;\n  var latepoint_stripe_elements;\n  var latepoint_stripe_elements_card_number;\n  var latepoint_stripe_elements_card_expiry;\n  var latepoint_stripe_elements_card_cvc;\n\n  function latepoint_register_stripe_card_elements(elements) {\n\n    // Listen for errors from each Element, and show error messages in the UI.\n    elements.forEach(function(element) {\n      element.on('change', function(event) {\n        if (event.error) {\n          latepoint_show_message_inside_element(event.error.message);\n        } else {\n          latepoint_hide_message_inside_element();\n        }\n      });\n    });\n\n  }\n\n\n  function latepoint_stripe_create_token($booking_form_wrapper){\n    // Gather additional customer data we may have collected in our form.\n    var name = jQuery($booking_form_wrapper).find('#payment_name_on_card');\n    var zip = jQuery($booking_form_wrapper).find('#payment_zip');\n    var additionalData = {\n      name: name ? name.value : undefined,\n      address_zip: zip ? zip.value : undefined,\n    };\n\n    // Use Stripe.js to create a token. We only need to pass in one Element\n    // from the Element group in order to create a token. We can also pass\n    // in the additional customer data we collected in our form.\n    latepoint_stripe.createToken(latepoint_stripe_elements_card_number, additionalData).then(function(result) {\n      // Stop loading!\n      // example.classList.remove('submitting');\n\n      if (result.token) {\n        // If we received a token, show the token ID.\n        latepoint_set_payment_token_and_submit($booking_form_wrapper, result.token.id);\n      } else {\n        latepoint_show_message_inside_element(result.error.message);\n        jQuery($booking_form_wrapper).find('.latepoint-next-btn').removeClass('os-loading');\n      }\n    });\n  }\n\n\n  function latepoint_init_stripe_form(){\n    latepoint_stripe = Stripe(latepoint_helper.stripe_key);\n\n    latepoint_stripe_elements = latepoint_stripe.elements();\n\n\n    var elementStyles = {\n      base: {\n        fontFamily: latepoint_helper.body_font_family,\n        fontSize: '14px',\n        fontWeight: 500,\n        color: '#ffffff',\n        '::placeholder': {\n          color: '#7d89b1',\n        },\n      }\n    };\n\n    var elementClasses = {\n      focus: 'focused',\n      empty: 'empty',\n      invalid: 'invalid',\n    };\n\n    latepoint_stripe_elements_card_number = latepoint_stripe_elements.create('cardNumber', {\n      style: elementStyles,\n      classes: elementClasses,\n      placeholder: jQuery('#payment_card_number').data('placeholder')\n    });\n    latepoint_stripe_elements_card_number.mount('#payment_card_number');\n\n    latepoint_stripe_elements_card_expiry = latepoint_stripe_elements.create('cardExpiry', {\n      style: elementStyles,\n      classes: elementClasses,\n      placeholder: jQuery('#payment_card_expiration').data('placeholder')\n    });\n    latepoint_stripe_elements_card_expiry.mount('#payment_card_expiration');\n\n    latepoint_stripe_elements_card_cvc = latepoint_stripe_elements.create('cardCvc', {\n      style: elementStyles,\n      classes: elementClasses,\n      placeholder: jQuery('#payment_card_cvc').data('placeholder')\n    });\n    latepoint_stripe_elements_card_cvc.mount('#payment_card_cvc');\n\n    latepoint_register_stripe_card_elements([latepoint_stripe_elements_card_number, latepoint_stripe_elements_card_expiry, latepoint_stripe_elements_card_cvc]);\n  }\n\n  function latepoint_init_step(step_name, $booking_form_wrapper = false){\n    latepoint_init_step_selectable_items();\n    latepoint_init_step_items_with_price();\n    switch(step_name){\n      case 'datepicker':\n        latepoint_init_step_datepicker();\n      break;\n      case 'contact':\n        latepoint_init_step_contact();\n      break;\n      case 'agents':\n        latepoint_init_step_agents();\n      break;\n      case 'locations':\n        latepoint_init_step_locations();\n      break;\n      case 'services':\n        latepoint_init_step_services()\n      break;\n      case 'payment':\n        latepoint_init_step_payment($booking_form_wrapper)\n      break;\n      case 'verify':\n        latepoint_init_step_verify($booking_form_wrapper)\n      break;\n      case 'confirmation':\n        latepoint_init_step_confirmation()\n      break;\n    }\n  }\n\n\n\n  function day_timeslots($day){\n    var $booking_form_wrapper = $day.closest('.latepoint-booking-form-element');\n    $day.addClass('selected');\n\n    var service_duration = $day.data('service-duration');\n    var interval = $day.data('interval');\n    var work_start_minutes = $day.data('work-start-time');\n    var work_end_minutes = $day.data('work-end-time');\n    var total_work_minutes = $day.data('total-work-minutes');\n    var available_minutes = $day.data('available-minutes') ? $day.data('available-minutes').toString().split(',').map(Number) : false;\n    var day_minutes = $day.data('day-minutes').toString().split(',').map(Number);\n\n    var $timeslots = $booking_form_wrapper.find('.timeslots');\n    $timeslots.html('');\n\n    if(total_work_minutes > 0 && available_minutes.length && day_minutes.length){\n      var prev_minutes = false;\n      day_minutes.forEach(function(current_minutes){\n        if((current_minutes + service_duration) > work_end_minutes) return;\n        var ampm = latepoint_am_or_pm(current_minutes);\n        if(prev_minutes !== false && ((current_minutes - prev_minutes) > service_duration)){\n          // show interval that is off between two work periods\n          var off_label = latepoint_minutes_to_hours_and_minutes(prev_minutes + service_duration)+' '+ latepoint_am_or_pm(prev_minutes + service_duration) + ' - ' + latepoint_minutes_to_hours_and_minutes(current_minutes)+' '+latepoint_am_or_pm(current_minutes);\n          var off_width = (((current_minutes - prev_minutes - service_duration) / (total_work_minutes + service_duration)) * 100);\n          $timeslots.append('<div class=\"dp-timeslot is-off\" style=\"max-width:'+ off_width +'%; width:'+ off_width +'%\"><span class=\"dp-label\">' + off_label + '</span></div>');\n        }\n\n        var timeslot_class = 'dp-timeslot';\n        if(!available_minutes.includes(current_minutes)){\n          timeslot_class+= ' is-booked';\n        }\n        var tick_html = '';\n        if(((current_minutes % 60) == 0) || (interval >= 60)){\n          timeslot_class+= ' with-tick';\n          tick_html = '<span class=\"dp-tick\"><strong>'+latepoint_minutes_to_hours_preferably(current_minutes)+'</strong>'+' '+ampm+'</span>';\n        }\n        var timeslot_label = latepoint_minutes_to_hours_and_minutes(current_minutes)+' '+ampm;\n        if(latepoint_show_booking_end_time()){\n          var end_minutes = current_minutes + service_duration;\n          var end_minutes_ampm = latepoint_am_or_pm(end_minutes);\n          timeslot_label+= ' - ' + latepoint_minutes_to_hours_and_minutes(end_minutes)+' '+end_minutes_ampm;\n        }\n        timeslot_label = timeslot_label.trim();\n        $timeslots.append('<div class=\"'+timeslot_class+'\" data-minutes=\"' + current_minutes + '\"><span class=\"dp-label\">'+ timeslot_label +'</span>'+tick_html+'</div>');\n\n        prev_minutes = current_minutes;\n      });\n    }else{\n      // No working hours this day\n      $timeslots.append('<div class=\"not-working-message\">' + latepoint_helper.msg_not_available + \"</div>\");\n    }\n  }\n\n\n\n\n  function os_init_timeslots(){\n    $('.dp-timeslot').on('click', function(){\n      var $booking_form_wrapper = $(this).closest('.latepoint-booking-form-element');\n      if($(this).hasClass('is-booked') || $(this).hasClass('is-off')){\n        // Show error message that you cant select a booked period\n      }else{\n        if($(this).hasClass('selected')){\n          $(this).removeClass('selected');\n          $(this).find('.dp-success-label').remove();\n          $booking_form_wrapper.find('.latepoint_start_time').val('');\n          hide_next_btn($booking_form_wrapper);\n          latepoint_update_summary_field($booking_form_wrapper, 'time', '');\n        }else{\n          $booking_form_wrapper.find('.dp-timeslot.selected').removeClass('selected').find('.dp-success-label').remove();\n          var selected_timeslot_time = $(this).find('.dp-label').html();\n          $(this).addClass('selected').find('.dp-label').html('<span class=\"dp-success-label\">' + $booking_form_wrapper.find('.latepoint-form').data('selected-label') + '</span>' + selected_timeslot_time);\n          $booking_form_wrapper.find('.latepoint_start_time').val($(this).data('minutes'));\n          show_next_btn($booking_form_wrapper);\n          latepoint_update_summary_field($booking_form_wrapper, 'time', selected_timeslot_time);\n        }\n      }\n      return false;\n    });\n  }\n\n  function os_init_monthly_calendar_navigation(){\n    $('.os-month-next-btn').on('click', function(){\n      var $booking_form_wrapper = $(this).closest('.latepoint-booking-form-element');\n      var next_month_route_name = $(this).data('route');\n      if($booking_form_wrapper.find('.os-monthly-calendar-days-w.active + .os-monthly-calendar-days-w').length){\n        $booking_form_wrapper.find('.os-monthly-calendar-days-w.active').removeClass('active').next('.os-monthly-calendar-days-w').addClass('active');\n        latepoint_calendar_set_month_label($booking_form_wrapper);\n      }else{\n        // TODO add condition to check maximum number months to call into the future\n        if(true){\n          var $btn = $(this);\n          $btn.addClass('os-loading');\n          var $calendar_element = $booking_form_wrapper.find('.os-monthly-calendar-days-w').last();\n          var calendar_year = $calendar_element.data('calendar-year');\n          var calendar_month = $calendar_element.data('calendar-month');\n          if(calendar_month == 12){\n            calendar_year = calendar_year + 1;\n            calendar_month = 1;\n          }else{\n            calendar_month = calendar_month + 1;\n          }\n          var booking_info = { target_date_string: calendar_year + '-' + calendar_month + '-1', \n                                location_id: $booking_form_wrapper.find('.latepoint_location_id').val(), \n                                agent_id: $booking_form_wrapper.find('.latepoint_agent_id').val(), \n                                service_id: $booking_form_wrapper.find('.latepoint_service_id').val(),\n                                duration: $booking_form_wrapper.find('input[name=\"booking[duration]\"]').val(),\n                                total_attendies: $booking_form_wrapper.find('input[name=\"booking[total_attendies]\"]').val() };\n          var data = { action: 'latepoint_route_call', route_name: next_month_route_name, params: booking_info, layout: 'none', return_format: 'json' }\n          $.ajax({\n            type : \"post\",\n            dataType : \"json\",\n            url : latepoint_helper.ajaxurl,\n            data : data,\n            success: function(data){\n              $btn.removeClass('os-loading');\n              if(data.status === \"success\"){\n                $booking_form_wrapper.find('.os-months').append(data.message);\n                $booking_form_wrapper.find('.os-monthly-calendar-days-w.active').removeClass('active').next('.os-monthly-calendar-days-w').addClass('active');\n                latepoint_calendar_set_month_label($booking_form_wrapper);\n              }else{\n                // console.log(data.message);\n              }\n            }\n          });\n        }\n      }\n      latepoint_calendar_show_or_hide_prev_next_buttons($booking_form_wrapper);\n      return false;\n    });\n    $('.os-month-prev-btn').on('click', function(){\n      var $booking_form_wrapper = $(this).closest('.latepoint-booking-form-element');\n      if($booking_form_wrapper.find('.os-monthly-calendar-days-w.active').prev('.os-monthly-calendar-days-w').length){\n        $booking_form_wrapper.find('.os-monthly-calendar-days-w.active').removeClass('active').prev('.os-monthly-calendar-days-w').addClass('active');\n        latepoint_calendar_set_month_label($booking_form_wrapper);\n      }\n      latepoint_calendar_show_or_hide_prev_next_buttons($booking_form_wrapper);\n      return false;\n    });\n  }\n\n  function latepoint_calendar_set_month_label($booking_form_wrapper){\n    $booking_form_wrapper.find('.os-current-month-label .current-year').text($booking_form_wrapper.find('.os-monthly-calendar-days-w.active').data('calendar-year'));\n    $booking_form_wrapper.find('.os-current-month-label .current-month').text($booking_form_wrapper.find('.os-monthly-calendar-days-w.active').data('calendar-month-label'));\n  }\n\n\n  function latepoint_calendar_show_or_hide_prev_next_buttons($booking_form_wrapper){\n    $booking_form_wrapper.find('.os-current-month-label .current-year').text($booking_form_wrapper.find('.os-monthly-calendar-days-w.active .os-monthly-calendar-days').data('calendar-year'));\n    $booking_form_wrapper.find('.os-current-month-label .current-month').text($booking_form_wrapper.find('.os-monthly-calendar-days-w.active .os-monthly-calendar-days').data('calendar-month-label'));\n\n    if($booking_form_wrapper.find('.os-monthly-calendar-days-w.active').prev('.os-monthly-calendar-days-w').length){\n      $booking_form_wrapper.find('.os-month-prev-btn').removeClass('disabled');\n    }else{\n      $booking_form_wrapper.find('.os-month-prev-btn').addClass('disabled');\n    }\n  }\n\n\n  function latepoint_init_step_datepicker(){\n    os_init_timeslots();\n    os_init_monthly_calendar_navigation();\n    $('.os-months').on('click', '.os-day', function(){\n      if($(this).hasClass('os-day-passed')) return false;\n      if($(this).hasClass('os-not-in-allowed-period')) return false;\n      var $booking_form_wrapper = $(this).closest('.latepoint-booking-form-element');\n      $booking_form_wrapper.find('.os-day.selected').removeClass('selected');\n      day_timeslots($(this));\n      os_init_timeslots();\n      $('.times-header span').text($(this).data('nice-date'));\n      $booking_form_wrapper.find('.time-selector-w').slideDown(200, function(){\n        var $scrollable_wrapper = $booking_form_wrapper.find('.latepoint-body');\n        $scrollable_wrapper.stop().animate({\n          scrollTop: $scrollable_wrapper[0].scrollHeight\n        }, 200);\n      });\n      $booking_form_wrapper.find('.latepoint_start_date').val($(this).data('date'));\n      latepoint_update_summary_field($booking_form_wrapper, 'date', $(this).data('nice-date'));\n\n      $booking_form_wrapper.find('.latepoint_start_time').val('');\n      hide_next_btn($booking_form_wrapper);\n      return false;\n    });\n  }\n\n  function latepoint_init_paypal_button($booking_form_element){\n    $booking_form_element.find('.lp-paypal-btn-trigger').html('');\n    if(latepoint_helper.is_braintree_paypal_active){\n      OsPaymentsBraintree.create_paypal_button($booking_form_element.find('.lp-paypal-btn-trigger')[0]);\n    }\n    if(latepoint_helper.is_paypal_native_active){\n      OsPaymentsPaypal.create_paypal_button($booking_form_element.find('.lp-paypal-btn-trigger')[0]);\n    }\n    $('.lp-paypal-demo-mode-trigger').on('click', function(){\n      $(this).closest('.latepoint-form').submit();\n    });\n  }\n\n\n  function latepoint_init_cc_form($booking_form_element = false){\n    if($booking_form_element){\n      if(!$booking_form_element.find('.lp-card-w').length) return;\n    }else{\n      if(!$('.lp-card-w').length) return;\n    }\n    if(latepoint_helper.is_braintree_active){\n      OsPaymentsBraintree.init_cc_form();\n    }\n    if(latepoint_helper.is_stripe_active){\n      latepoint_init_stripe_form();\n    }\n  }\n\n  function latepoint_init_step_verify($booking_form_element = false){\n    if(!$booking_form_element) return;\n\n    $booking_form_element.closest('.latepoint-summary-is-open').removeClass('latepoint-summary-is-open');\n  }\n\n\n  function latepoint_init_step_payment($booking_form_element = false){\n    if($booking_form_element.find('.step-payment-w').data('full-amount') > 0){\n      latepoint_update_summary_field($booking_form_element, 'price', latepoint_format_price($booking_form_element.find('.step-payment-w').data('full-amount')));\n    }\n    if($booking_form_element && ($booking_form_element.find('.step-payment-w').data('default-portion') == 'deposit')){\n      $booking_form_element.find('input[name=\"booking[payment_portion]\"]').val('deposit');\n    }\n    latepoint_init_cc_form($booking_form_element);\n\n    if($booking_form_element && ($booking_form_element.find('.step-payment-w').data('current-payment-step') == 'lp-show-paypal')){\n      latepoint_init_paypal_button($booking_form_element);\n      hide_next_btn($booking_form_element);\n    }\n\n    $('.latepoint-booking-form-element .coupon-code-input-submit').on('click', function(e){\n      latepoint_apply_coupon($(this).closest('.coupon-code-input-w').find('.coupon-code-input'));\n      return false;\n    });\n\n    $('.latepoint-booking-form-element input.coupon-code-input').on('keyup', function(e){\n      if(e.which === 13){\n        latepoint_apply_coupon($(this));\n        return false;\n      }\n    });\n\n\n    $('.latepoint-booking-form-element .coupon-code-trigger-w a').on('click', function(e){\n      $(this).closest('.payment-total-info').addClass('entering-coupon').find('.coupon-code-input').focus();\n      return false;\n    });\n\n\n    $('.latepoint-booking-form-element .lp-payment-trigger-locally').on('click', function(e){\n      var $booking_form_element = $(this).closest('.latepoint-booking-form-element');\n      $booking_form_element.find('input[name=\"booking[payment_method]\"]').val($(this).data('method'));\n      $booking_form_element.find('input[name=\"booking[payment_portion]\"]').val('');\n      show_next_btn($booking_form_element);\n    });\n\n    $('.latepoint-booking-form-element .lp-payment-trigger-method-selector').on('click', function(e){\n      var $booking_form_element = $(this).closest('.latepoint-booking-form-element');\n      var $payment_step = $booking_form_element.find('.step-payment-w');\n      var current_payment_step_class = $payment_step.data('current-payment-step');\n      var new_current_payment_step_class = 'lp-show-pay-methods';\n\n      $payment_step.removeClass(current_payment_step_class)\n                  .addClass(new_current_payment_step_class)\n                  .data('current-payment-step', new_current_payment_step_class)\n                  .data('prev-payment-step', current_payment_step_class);\n      hide_next_btn($booking_form_element);\n      show_prev_btn($booking_form_element);\n      return false;\n    });\n\n    $('.latepoint-booking-form-element .lp-payment-trigger-cc').on('click', function(e){\n      var $booking_form_element = $(this).closest('.latepoint-booking-form-element');\n      $booking_form_element.find('input[name=\"booking[payment_method]\"]').val($(this).data('method'));\n\n      var $payment_step = $booking_form_element.find('.step-payment-w');\n      var current_payment_step_class = $payment_step.data('current-payment-step');\n      var new_current_payment_step_class = 'lp-show-pay-portion-selection';\n\n      if(!$booking_form_element.find('.lp-payment-portion-selection-w').length){\n        // no deposits allowed\n        new_current_payment_step_class = 'lp-show-card';\n        show_next_btn($booking_form_element);\n      }else{\n        hide_next_btn($booking_form_element);\n      }\n      show_prev_btn($booking_form_element);\n      $payment_step.removeClass(current_payment_step_class)\n                  .addClass(new_current_payment_step_class)\n                  .data('current-payment-step', new_current_payment_step_class)\n                  .data('prev-payment-step', current_payment_step_class);\n    });\n\n    $('.latepoint-booking-form-element .lp-payment-trigger-paypal').on('click', function(e){\n      var $booking_form_element = $(this).closest('.latepoint-booking-form-element');\n      $booking_form_element.find('input[name=\"booking[payment_method]\"]').val($(this).data('method'));\n\n      var $payment_step = $booking_form_element.find('.step-payment-w');\n      var current_payment_step_class = $payment_step.data('current-payment-step');\n      var new_current_payment_step_class = 'lp-show-pay-portion-selection';\n\n      if(!$booking_form_element.find('.lp-payment-portion-selection-w').length){\n        // no deposits allowed\n        latepoint_init_paypal_button($booking_form_element);\n        new_current_payment_step_class = 'lp-show-paypal';\n      }\n\n      $payment_step.removeClass(current_payment_step_class)\n                  .addClass(new_current_payment_step_class)\n                  .data('current-payment-step', new_current_payment_step_class)\n                  .data('prev-payment-step', current_payment_step_class);\n\n      hide_next_btn($booking_form_element);\n      show_prev_btn($booking_form_element);\n    });\n\n    $('.latepoint-booking-form-element .lp-trigger-payment-portion-selector').on('click', function(e){\n      var $booking_form_element = $(this).closest('.latepoint-booking-form-element');\n      var portion = jQuery(this).data('portion');\n      $booking_form_element.find('input[name=\"booking[payment_portion]\"]').val(portion);\n      if(portion == 'deposit'){\n        $booking_form_element.find('.payment-total-info').addClass('paying-deposit');\n      }else{\n        $booking_form_element.find('.payment-total-info').removeClass('paying-deposit');\n      }\n\n      var $payment_step = $booking_form_element.find('.step-payment-w');\n      var current_payment_step_class = $payment_step.data('current-payment-step');\n      var new_current_payment_step_class = 'lp-show-card';\n      \n      if($booking_form_element.find('input[name=\"booking[payment_method]\"]').val() == 'card'){\n        // card\n        show_next_btn($booking_form_element);\n      }else{\n        // paypal\n        latepoint_init_paypal_button($booking_form_element);\n        new_current_payment_step_class = 'lp-show-paypal';\n        hide_next_btn($booking_form_element);\n      }\n      show_prev_btn($booking_form_element);\n\n      $payment_step.removeClass(current_payment_step_class)\n                  .addClass(new_current_payment_step_class)\n                  .data('current-payment-step', new_current_payment_step_class)\n                  .data('prev-payment-step', current_payment_step_class);\n    });\n\n\n  }\n\n\n  function latepoint_init_step_selectable_items(){\n    $('.os-selectable-items .os-selectable-item').off('click', latepoint_selectable_item_clicked);\n    $('.os-selectable-items .os-selectable-item').on('click', latepoint_selectable_item_clicked);\n  }\n\n  function latepoint_init_step_items_with_price(){\n    $('.os-selectable-items .os-priced-item').off('click', latepoint_priced_item_clicked);\n    $('.os-selectable-items .os-priced-item').on('click', latepoint_priced_item_clicked);\n  }\n\n  function latepoint_priced_item_clicked(){\n    var $booking_form_wrapper = $(this).closest('.latepoint-booking-form-element');\n    var operator = '=';\n    if($(this).hasClass('os-allow-multiselect')){\n      operator = ($(this).hasClass('selected')) ? '+' : '-';\n    }\n    latepoint_update_booking_component_price($(this).data('item-price'), $(this).data('priced-item-type'), $booking_form_wrapper, operator);\n    return false;\n  }\n\n  function latepoint_calculate_total_price($booking_form_wrapper){\n    var total_price = 0;\n    $booking_form_wrapper.find('.latepoint-priced-component').each(function(){\n      total_price+= Number($(this).val());\n    });\n    $booking_form_wrapper.find('.latepoint_total_price').val(total_price);\n    if(total_price > 0){\n      if($booking_form_wrapper.find('.latepoint_total_attendies').val() > 1) total_price = (total_price * $booking_form_wrapper.find('.latepoint_total_attendies').val()).toFixed(2);\n      total_price = latepoint_format_price(total_price);\n      latepoint_update_summary_field($booking_form_wrapper, 'price', total_price);\n    }else{\n      latepoint_update_summary_field($booking_form_wrapper, 'price', '');\n    }\n  }\n\n  function latepoint_update_booking_component_price(amount, item_type, $booking_form_wrapper, operator){\n    var item_type_class = '.latepoint_' + item_type + '_price';\n    var price = Number($('.latepoint-priced-component' + item_type_class).val()) * 100;\n    amount = Number(amount) * 100;\n    if(operator == '='){\n      price = amount;\n    }else{\n      price = (operator == '+') ? price + amount : price - amount;\n    }\n    price = price / 100;\n    $('.latepoint-priced-component' + item_type_class).val(price);\n    latepoint_calculate_total_price($booking_form_wrapper)\n  }\n\n  function latepoint_selectable_item_clicked(){\n    var $booking_form_wrapper = $(this).closest('.latepoint-booking-form-element');\n    var summary_value = '';\n    if($(this).hasClass('os-allow-multiselect')){\n      $(this).toggleClass('selected');\n      var ids = $(this).closest('.os-selectable-items').find('.os-selectable-item.selected').map(function(){ return $(this).data('item-id'); }).get();\n      $booking_form_wrapper.find($(this).data('id-holder')).val(ids);\n      summary_value = String($(this).closest('.os-selectable-items').find('.os-selectable-item.selected').map(function(){ return (' ' + $(this).data('summary-value')); }).get()).trim();\n      show_next_btn($booking_form_wrapper);\n    }else{\n      $(this).closest('.os-selectable-items').find('.os-selectable-item.selected').removeClass('selected');\n      $(this).addClass('selected');\n      $booking_form_wrapper.find($(this).data('id-holder')).val($(this).data('item-id'));\n      summary_value = $(this).data('summary-value');\n      if($(this).data('os-call-func')){\n        window[$(this).data('os-call-func')]($(this));\n      }\n      if($(this).data('activate-sub-step')){\n        window[$(this).data('activate-sub-step')]($(this));\n      }else{\n        trigger_next_or_show_next_button($booking_form_wrapper);\n      }\n    }\n    latepoint_update_summary_field($booking_form_wrapper, $(this).data('summary-field-name'), summary_value);\n  }\n\n\n  function latepoint_format_price(price){\n    return latepoint_helper.currency_symbol_before + String(price) + latepoint_helper.currency_symbol_after;\n  }\n\n\n  function latepoint_init_step_services(){\n    $('.quantity-selector-input').on('change', function(){\n      var $booking_form_wrapper = $(this).closest('.latepoint-booking-form-element');\n      $booking_form_wrapper.find('.latepoint_total_attendies').val($(this).val());\n      latepoint_update_summary_field($booking_form_wrapper, 'total-attendies', $(this).val());\n      latepoint_calculate_total_price($booking_form_wrapper);\n    });\n    $('.quantity-selector').on('click', function(){\n      var add_value = ($(this).hasClass('quantity-selector-plus')) ? 1 : -1;\n      var max_capacity = $(this).closest('.quantity-selector-w').data('max-capacity');\n      var current_value = $(this).closest('.quantity-selector-w').find('input.quantity-selector-input').val();\n      var new_value = (Number(current_value) > 0) ? Math.max((Number(current_value) + add_value), 1) : 1;\n      new_value = Math.min(Number(max_capacity), new_value);\n      $(this).closest('.latepoint-booking-form-element').find('.latepoint_total_attendies').val(new_value);\n      $(this).closest('.quantity-selector-w').find('input').val(new_value).trigger('change');\n      return false;\n    });\n    $('.os-service-category-info').on('click', function(){\n      var $booking_form_wrapper = $(this).closest('.latepoint-booking-form-element');\n      show_prev_btn($booking_form_wrapper);\n      $(this).closest('.step-services-w').addClass('selecting-service-category');\n      var $category_wrapper = $(this).closest('.os-service-category-w');\n      var $main_parent = $(this).closest('.os-service-categories-main-parent');\n      if($category_wrapper.hasClass('selected')){\n        $category_wrapper.removeClass('selected');\n        if($category_wrapper.parent().closest('.os-service-category-w').length){\n          $category_wrapper.parent().closest('.os-service-category-w').addClass('selected');\n        }else{\n          $main_parent.removeClass('show-selected-only');\n        }\n      }else{\n        $main_parent.find('.os-service-category-w.selected').removeClass('selected');\n        $main_parent.addClass('show-selected-only');\n        $category_wrapper.addClass('selected');\n      }\n      return false;\n    });\n  }\n\n\n  function trigger_next_or_show_next_button($booking_form_wrapper){\n    if(!latepoint_helper.manual_next_step || latepoint_helper.manual_next_step == 'off'){\n      $booking_form_wrapper.find('.latepoint_step_direction').val('next');\n      $booking_form_wrapper.find('.latepoint-form').submit();\n    }else{\n      show_next_btn($booking_form_wrapper);\n    }\n  }\n\n  function latepoint_init_step_locations(){\n  }\n\n  function latepoint_init_step_agents(){\n    $('.os-items .os-item-details-btn').on('click', function(){\n      var $booking_form_wrapper = $(this).closest('.latepoint-booking-form-element');\n      var agent_id = $(this).data('agent-id');\n      $booking_form_wrapper.find('.os-agent-bio-popup.active').removeClass('active');\n      $booking_form_wrapper.find('#osAgentBioPopup' + agent_id).addClass('active');\n      return false;\n    });\n    $('.os-agent-bio-close').on('click', function(){\n      $(this).closest('.os-agent-bio-popup').removeClass('active');\n      return false;\n    });\n  }\n\n\n  function latepoint_init_step_confirmation(){\n\n    $('.latepoint-booking-form-element').on('click', '.set-customer-password-btn', function(){\n      var $btn = $(this);\n      var $booking_form_wrapper = $(this).closest('.latepoint-booking-form-element');\n\n      $btn.addClass('os-loading');\n      var params = { account_nonse: $('input[name=\"account_nonse\"]').val(), password: $('input[name=\"customer[password]\"]').val(), password_confirmation: $('input[name=\"customer[password_confirmation]\"]').val()}\n      var data = { action: 'latepoint_route_call', route_name: $(this).data('btn-action'), params: $.param(params), layout: 'none', return_format: 'json' }\n      $.ajax({\n        type : \"post\",\n        dataType : \"json\",\n        url : latepoint_helper.ajaxurl,\n        data : data,\n        success: function(data){\n          $btn.removeClass('os-loading');\n          if(data.status === \"success\"){\n            $booking_form_wrapper.find('.step-confirmation-set-password').html('').hide();\n            $booking_form_wrapper.find('.confirmation-cabinet-info').show();\n          }else{\n            latepoint_show_message_inside_element(data.message, $booking_form_wrapper.find('.step-confirmation-set-password'), 'error');\n          }\n        }\n      });\n      return false;\n    });\n\n    $('.latepoint-booking-form-element').on('click', '.qr-show-trigger', function(){\n      var $booking_form_wrapper = $(this).closest('.latepoint-booking-form-element');\n      $booking_form_wrapper.find('.qr-code-on-confirmation').addClass('show-vevent-qr-code');\n      return false;\n    });\n\n    $('.latepoint-booking-form-element').on('click', '.show-set-password-fields', function(){\n      var $booking_form_wrapper = $(this).closest('.latepoint-booking-form-element');\n\n      $booking_form_wrapper.find('.step-confirmation-set-password').show();\n      $booking_form_wrapper.find('#customer_password').focus();\n      $(this).closest('.info-box').hide();\n      return false;\n    });\n  }\n\n\n  function latepoint_init_customer_dashboard_login(){\n    if($('.latepoint-login-form-w #facebook-signin-btn').length && $('.latepoint-login-form-w').length){\n      $('.latepoint-login-form-w #facebook-signin-btn').on('click', function(){\n        var $login_form_wrapper = $(this).closest('.latepoint-login-form-w');\n        FB.login(function(response){\n          if (response.status === 'connected' && response.authResponse) {\n            var params = { token: response.authResponse.accessToken};\n            var data = { action: 'latepoint_route_call', route_name: $login_form_wrapper.find('#facebook-signin-btn').data('login-action'), params: $.param(params), layout: 'none', return_format: 'json' };\n            latepoint_step_content_change_start($login_form_wrapper);\n            $.ajax({\n              type : \"post\",\n              dataType : \"json\",\n              url : latepoint_helper.ajaxurl,\n              data : data,\n              success: function(data){\n                if(data.status === \"success\"){\n                  location.reload();\n                }else{\n                  latepoint_show_message_inside_element(data.message, $login_form_wrapper);\n                  latepoint_step_content_change_end(false, $login_form_wrapper);\n                }\n              }\n            });\n          } else {\n            \n          }\n        }, {scope: 'public_profile,email'});\n      });\n    }\n\n    if($('.latepoint-login-form-w #google-signin-btn').length && $('.latepoint-login-form-w').length){\n      // INIT GOOGLE LOGIN\n      var googleUser = {};\n\n      var $login_form_wrappers = $('.latepoint-login-form-w');\n      $login_form_wrappers.each(function(){\n        var $login_form_wrapper = $(this);\n        gapi.load('auth2', function(){\n          // Retrieve the singleton for the GoogleAuth library and set up the client.\n          var auth2 = gapi.auth2.init({\n            client_id: $login_form_wrapper.find('meta[name=google-signin-client_id]').attr(\"content\"),\n            cookiepolicy: 'single_host_origin',\n            // Request scopes in addition to 'profile' and 'email'\n            //scope: 'additional_scope'\n          });\n\n          auth2.attachClickHandler($login_form_wrapper.find('#google-signin-btn')[0], {},\n            function(googleUser) {\n              var params = { token: googleUser.getAuthResponse().id_token};\n              var data = { action: 'latepoint_route_call', route_name: $login_form_wrapper.find('#google-signin-btn').data('login-action'), params: $.param(params), layout: 'none', return_format: 'json' };\n              latepoint_step_content_change_start($login_form_wrapper);\n              $.ajax({\n                type : \"post\",\n                dataType : \"json\",\n                url : latepoint_helper.ajaxurl,\n                data : data,\n                success: function(data){\n                  if(data.status === \"success\"){\n                    location.reload();\n                  }else{\n                    latepoint_show_message_inside_element(data.message, $login_form_wrapper);\n                    latepoint_step_content_change_end(false, $login_form_wrapper);\n                  }\n                }\n              });\n            }, function(error) {\n              // console.log(JSON.stringify(error, undefined, 2));\n            });\n        });\n      });\n    }\n  }\n\n\n  function latepoint_init_step_contact(){\n    latepoint_init_facebook_login();\n    latepoint_init_google_login();\n    latepoint_init_form_masks();\n\n    $('.step-contact-w').each(function(){\n      var customer_name = $(this).find('input[name=\"customer[first_name]\"]').val() + ' ' + $(this).find('input[name=\"customer[last_name]\"]').val();\n      customer_name = customer_name.trim();\n      latepoint_update_summary_field($(this).closest('.latepoint-booking-form-element'), 'customer', customer_name);\n    });\n\n    $('.step-contact-w').on('keyup', 'input[name=\"customer[first_name]\"], input[name=\"customer[last_name]\"]', function(){\n      var $booking_form_wrapper = $(this).closest('.latepoint-booking-form-element');\n      latepoint_update_summary_field($booking_form_wrapper, 'customer', $booking_form_wrapper.find('input[name=\"customer[first_name]\"]').val() + ' ' + $booking_form_wrapper.find('input[name=\"customer[last_name]\"]').val());\n    });\n\n    $('.step-contact-w').on('keyup', '.os-form-control.required', function(){\n      var $booking_form_wrapper = $(this).closest('.latepoint-booking-form-element');\n      if(latepoint_validate_fields($booking_form_wrapper.find('.step-contact-w .os-form-control.required'))){\n      }else{\n      }\n    });\n\n    // Init Logout button\n    $('.step-customer-logout-btn').on('click', function(){\n      var $booking_form_wrapper = $(this).closest('.latepoint-booking-form-element');\n      var data = { action: 'latepoint_route_call', route_name: $(this).data('btn-action'), layout: 'none', return_format: 'json' }\n      latepoint_step_content_change_start($booking_form_wrapper);\n      $.ajax({\n        type : \"post\",\n        dataType : \"json\",\n        url : latepoint_helper.ajaxurl,\n        data : data,\n        success: function(data){\n          latepoint_reload_step($booking_form_wrapper);\n        }\n      });\n      return false;\n    });\n\n    // Init Login Existing Customer Button\n    $('.step-login-existing-customer-btn').on('click', function(){\n      var $booking_form_wrapper = $(this).closest('.latepoint-booking-form-element');\n      var params = { email: $booking_form_wrapper.find('.os-step-existing-customer-login-w input[name=\"customer_login[email]\"]').val(), password: $booking_form_wrapper.find('.os-step-existing-customer-login-w input[name=\"customer_login[password]\"]').val()}\n      var data = { action: 'latepoint_route_call', route_name: $(this).data('btn-action'), params: $.param(params), layout: 'none', return_format: 'json' }\n      latepoint_step_content_change_start($booking_form_wrapper);\n      $.ajax({\n        type : \"post\",\n        dataType : \"json\",\n        url : latepoint_helper.ajaxurl,\n        data : data,\n        success: function(data){\n            if(data.status === \"success\"){\n              latepoint_reload_step($booking_form_wrapper);\n            }else{\n              latepoint_show_message_inside_element(data.message, $booking_form_wrapper.find('.os-step-existing-customer-login-w'));\n              latepoint_step_content_change_end(false, $booking_form_wrapper);\n            }\n        }\n      });\n      return false;\n    });\n  }\n\n  function latepoint_step_content_change_start($booking_form_wrapper){\n    $booking_form_wrapper.removeClass('step-content-loaded').addClass('step-content-loading');\n  }\n\n  // TODO\n  function latepoint_step_content_change_end(new_content, $booking_form_wrapper){\n    if(new_content) $booking_form_wrapper.find('.latepoint-body .latepoint-step-content').replaceWith(new_content);\n    $booking_form_wrapper.removeClass('step-content-loading').addClass('step-content-mid-loading');\n    setTimeout(function(){\n      $booking_form_wrapper.removeClass('step-content-mid-loading').addClass('step-content-loaded');\n    }, 50);\n  }\n\n  function latepoint_init_facebook_login(){\n    if(!$('#facebook-signin-btn').length || !$('.latepoint-booking-form-element').length) return;\n    $('#facebook-signin-btn').on('click', function(){\n      var $booking_form_wrapper = $(this).closest('.latepoint-booking-form-element');\n      FB.login(function(response){\n        if (response.status === 'connected' && response.authResponse) {\n          var params = { token: response.authResponse.accessToken};\n          var data = { action: 'latepoint_route_call', route_name: $booking_form_wrapper.find('#facebook-signin-btn').data('login-action'), params: $.param(params), layout: 'none', return_format: 'json' };\n          latepoint_step_content_change_start($booking_form_wrapper);\n          $.ajax({\n            type : \"post\",\n            dataType : \"json\",\n            url : latepoint_helper.ajaxurl,\n            data : data,\n            success: function(data){\n              if(data.status === \"success\"){\n                latepoint_reload_step($booking_form_wrapper);\n              }else{\n                latepoint_show_message_inside_element(data.message, $booking_form_wrapper.find('.os-step-existing-customer-login-w '));\n                latepoint_step_content_change_end(false, $booking_form_wrapper);\n              }\n            }\n          });\n        } else {\n          \n        }\n      }, {scope: 'public_profile,email'});\n    });\n  }\n\n  function latepoint_init_google_login(){\n    if(!$('#google-signin-btn').length || !$('.latepoint-booking-form-element').length) return;\n    var googleUser = {};\n\n    var $booking_form_wrappers = $('.latepoint-booking-form-element');\n    $booking_form_wrappers.each(function(){\n      var $booking_form_wrapper = $(this);\n      gapi.load('auth2', function(){\n        // Retrieve the singleton for the GoogleAuth library and set up the client.\n        var auth2 = gapi.auth2.init({\n          client_id: $booking_form_wrapper.find('meta[name=google-signin-client_id]').attr(\"content\"),\n          cookiepolicy: 'single_host_origin',\n          // Request scopes in addition to 'profile' and 'email'\n          //scope: 'additional_scope'\n        });\n\n        auth2.attachClickHandler($booking_form_wrapper.find('#google-signin-btn')[0], {},\n          function(googleUser) {\n            var params = { token: googleUser.getAuthResponse().id_token};\n            var data = { action: 'latepoint_route_call', route_name: $booking_form_wrapper.find('#google-signin-btn').data('login-action'), params: $.param(params), layout: 'none', return_format: 'json' };\n            latepoint_step_content_change_start($booking_form_wrapper);\n            $.ajax({\n              type : \"post\",\n              dataType : \"json\",\n              url : latepoint_helper.ajaxurl,\n              data : data,\n              success: function(data){\n                if(data.status === \"success\"){\n                  latepoint_reload_step($booking_form_wrapper);\n                }else{\n                  latepoint_show_message_inside_element(data.message, $booking_form_wrapper.find('.os-step-existing-customer-login-w '));\n                  latepoint_step_content_change_end(false, $booking_form_wrapper);\n                }\n              }\n            });\n          }, function(error) {\n            // console.log(JSON.stringify(error, undefined, 2));\n          });\n      });\n    });\n  }\n\n  function latepoint_change_step_desc($booking_form_wrapper, step_name){\n    $booking_form_wrapper.removeClass('step-changed').addClass('step-changing');\n    setTimeout(function(){\n      // Progress bar\n      var $step_progress = $booking_form_wrapper.find('.latepoint-progress li[data-step-name=\"' + step_name + '\"]');\n      $step_progress.addClass('active').addClass('complete').prevAll().addClass('complete').removeClass('active');\n      $step_progress.nextAll().removeClass('complete').removeClass('active');\n      // Side panel\n      var side_panel_desc = $booking_form_wrapper.find('.latepoint-step-desc-library[data-step-name=\"' + step_name + '\"]').html();\n      $booking_form_wrapper.find('.latepoint-step-desc').html(side_panel_desc);\n\n      // Top header\n      var top_header_desc = $booking_form_wrapper.find('.os-heading-text-library[data-step-name=\"' + step_name + '\"]').html();\n      $booking_form_wrapper.find('.os-heading-text').html(top_header_desc);\n      setTimeout(function(){\n          $booking_form_wrapper.removeClass('step-changing').addClass('step-changed');\n      }, 50);\n    }, 500);\n  }\n\n\n  function latepoint_progress_prev($booking_form_wrapper, step_name){\n    var $step_progress = $booking_form_wrapper.find('.latepoint-progress li[data-step-name=\"' + step_name + '\"]');\n    $step_progress.addClass('active').addClass('complete').prevAll().addClass('complete').removeClass('active');\n    $step_progress.nextAll().removeClass('complete').removeClass('active');\n  }\n\n\n  function latepoint_progress_next($booking_form_wrapper, step_name){\n    var $step_progress = $booking_form_wrapper.find('.latepoint-progress li[data-step-name=\"' + step_name + '\"]');\n    $step_progress.addClass('active').addClass('complete').prevAll().addClass('complete').removeClass('active');\n    $step_progress.nextAll().removeClass('complete').removeClass('active');\n  }\n\n\n  function latepoint_next_step_description($booking_form_wrapper, step_name){\n    $booking_form_wrapper.removeClass('step-changed').addClass('step-changing');\n    setTimeout(function(){\n      $booking_form_wrapper.find('.latepoint-step-desc').html($booking_form_wrapper.find('.latepoint-step-desc-library.active').removeClass('active').next('.latepoint-step-desc-library').addClass('active').html());\n      $booking_form_wrapper.find('.os-heading-text').html($booking_form_wrapper.find('.os-heading-text-library.active').removeClass('active').next('.os-heading-text-library').addClass('active').html());\n      setTimeout(function(){\n        $booking_form_wrapper.removeClass('step-changing').addClass('step-changed');\n      }, 50);\n    }, 500);\n  }\n  function latepoint_prev_step_description($booking_form_wrapper, step_name){\n    $booking_form_wrapper.removeClass('step-changed').addClass('step-changing');\n    setTimeout(function(){\n      $booking_form_wrapper.find('.latepoint-step-desc').html($booking_form_wrapper.find('.latepoint-step-desc-library.active').removeClass('active').prev('.latepoint-step-desc-library').addClass('active').html());\n      $booking_form_wrapper.find('.os-heading-text').html($booking_form_wrapper.find('.os-heading-text-library.active').removeClass('active').prev('.os-heading-text-library').addClass('active').html());\n      setTimeout(function(){\n        $booking_form_wrapper.removeClass('step-changing').addClass('step-changed');\n      }, 50);\n    }, 500);\n  }\n\n\n  function latepoint_validate_fields($fields){\n    var is_valid = true;\n    $fields.each(function(index){\n      if($(this).val() == ''){\n        is_valid = false;\n        return false;\n      }\n    });\n    return is_valid;\n  }\n\n\n  function latepoint_init_booking_form(){\n    $('.latepoint-lightbox-close').on('click', function(){\n      $('body').removeClass('latepoint-lightbox-active');\n      $('.latepoint-lightbox-w').remove();\n      return false;\n    });\n\n\n    $('.latepoint-customer-timezone-selector-w select').on('change', function(e){\n      var $select_box = $(this);\n      $select_box.closest('.latepoint-customer-timezone-selector-w').addClass('os-loading');\n      var data = { action: 'latepoint_route_call', route_name: $(this).closest('.latepoint-customer-timezone-selector-w').data('route-name'), params: { timezone_name: $(this).val()}, layout: 'none', return_format: 'json'}\n      $.ajax({\n        type : \"post\",\n        dataType : \"json\",\n        url : latepoint_helper.ajaxurl,\n        data : data,\n        success: function(data){\n          $select_box.closest('.latepoint-customer-timezone-selector-w').removeClass('os-loading');\n          if(data.status === \"success\"){\n            location.reload();\n          }else{\n\n          }\n        }\n      });\n    });\n\n    $('.latepoint-timezone-selector-w select').on('change', function(e){\n      var $select_box = $(this);\n      $select_box.closest('.latepoint-timezone-selector-w').addClass('os-loading');\n      var data = { action: 'latepoint_route_call', route_name: $(this).closest('.latepoint-timezone-selector-w').data('route-name'), params: { timezone_name: $(this).val()}, layout: 'none', return_format: 'json'}\n      var $booking_form_wrapper = $select_box.closest('.latepoint-booking-form-element');\n      $booking_form_wrapper.removeClass('step-content-loaded').addClass('step-content-loading');\n      $.ajax({\n        type : \"post\",\n        dataType : \"json\",\n        url : latepoint_helper.ajaxurl,\n        data : data,\n        success: function(data){\n          $select_box.closest('.latepoint-timezone-selector-w').removeClass('os-loading');\n          $booking_form_wrapper.removeClass('step-content-loading');\n          if(data.status === \"success\"){\n            // reload datepicker if its the step\n            if($select_box.closest('.latepoint-booking-form-element').hasClass('current-step-datepicker')){\n              latepoint_reload_step($select_box.closest('.latepoint-booking-form-element'));\n            }\n          }else{\n\n          }\n        }\n      });\n    });\n\n    if(!latepoint_helper.is_timezone_selected){\n      const tzid = Intl.DateTimeFormat().resolvedOptions().timeZone;\n      if(tzid){\n        if(tzid != $('.latepoint-timezone-selector-w select').val()) $('.latepoint-timezone-selector-w select').val(tzid).change();\n      }\n    }\n\n    $('.latepoint-booking-form-element .latepoint-form').on('submit', function(e){\n      var $booking_form = $(this);\n      var $booking_form_wrapper = $(this).closest('.latepoint-booking-form-element');\n      e.preventDefault();\n      var form_data = $booking_form.serialize();\n      var data = { action: 'latepoint_route_call', route_name: $booking_form.data('route-name'), params: form_data, layout: 'none', return_format: 'json'}\n      $booking_form_wrapper.removeClass('step-content-loaded').addClass('step-content-loading');\n      $.ajax({\n        type : \"post\",\n        dataType : \"json\",\n        url : latepoint_helper.ajaxurl,\n        data : data,\n        success: function(data){\n          if(data.status === \"success\"){\n            $booking_form_wrapper.find('.latepoint_current_step').val(data.step_name);\n            $booking_form_wrapper.removeClass(function (index, className) { return (className.match (/(^|\\s)current-step-\\S+/g) || []).join(' '); }).addClass('current-step-' + data.step_name);\n            setTimeout(function(){\n              $booking_form_wrapper.removeClass('step-content-loading').addClass('step-content-mid-loading');\n              $booking_form_wrapper.find('.latepoint-body').html(data.message);\n              latepoint_init_step(data.step_name, $booking_form_wrapper);\n              setTimeout(function(){\n                $booking_form_wrapper.removeClass('step-content-mid-loading').addClass('step-content-loaded');\n                $booking_form_wrapper.find('.latepoint-next-btn, .latepoint-prev-btn').removeClass('os-loading');\n              }, 50);\n            }, 500);\n\n            if(data.is_pre_last_step){\n              $booking_form_wrapper.find('.latepoint-next-btn span').text($booking_form_wrapper.find('.latepoint-next-btn').data('pre-last-step-label'));\n            }else{\n              $booking_form_wrapper.find('.latepoint-next-btn span').text($booking_form_wrapper.find('.latepoint-next-btn').data('label'));\n            }\n            if(data.is_last_step){\n              $booking_form_wrapper.addClass('hidden-buttons').find('.latepoint-footer').remove();\n              $booking_form_wrapper.find('.latepoint-progress').css( 'opacity', 0 );\n              $booking_form_wrapper.closest('.latepoint-summary-is-open').removeClass('latepoint-summary-is-open');\n              $booking_form_wrapper.addClass('is-final-step');\n            }else{\n              if(data.show_next_btn === true){\n                show_next_btn($booking_form_wrapper);\n              }else{\n                hide_next_btn($booking_form_wrapper);\n              }\n              if(data.show_prev_btn === true){\n                show_prev_btn($booking_form_wrapper);\n              }else{\n                hide_prev_btn($booking_form_wrapper);\n              }\n            }\n            \n\n            latepoint_change_step_desc($booking_form_wrapper, data.step_name);\n          }else{\n            $booking_form_wrapper.removeClass('step-content-loading').addClass('step-content-loaded');\n            $booking_form_wrapper.find('.latepoint-next-btn, .latepoint-prev-btn').removeClass('os-loading');\n            latepoint_show_message_inside_element(data.message, $booking_form_wrapper.find('.latepoint-body'));\n          }\n          $booking_form.find('.latepoint_step_direction').val('next');\n        }\n      });\n    });\n\n    \n\n    $('.latepoint-booking-form-element').on('click', '.lp-option', function(){\n      $(this).closest('.lp-options').find('.lp-option.selected').removeClass('selected');\n      $(this).addClass('selected');\n    });\n\n\n\n\n    // Next Step button Click\n    $('.latepoint-booking-form-element .latepoint-next-btn').on('click', function(e){\n      if($(this).hasClass('disabled') || $(this).hasClass('os-loading')) return false;\n      var $booking_form = $(this).closest('.latepoint-form');\n      var $booking_form_wrapper = $booking_form.closest('.latepoint-booking-form-element');\n\n      $booking_form.find('.latepoint_step_direction').val('next');\n      if(($booking_form_wrapper.find('.latepoint_current_step').val() == 'payment') && ($booking_form_wrapper.find('input[name=\"booking[payment_method]\"]').val() == 'card') && !latepoint_helper.demo_mode){\n        if(latepoint_helper.is_stripe_active){\n          latepoint_stripe_create_token($booking_form_wrapper);\n        }\n        if(latepoint_helper.is_braintree_active){\n          OsPaymentsBraintree.create_token($booking_form_wrapper);\n        }\n      }else{\n        $booking_form.submit();\n      }\n      $(this).addClass('os-loading');\n      return false;\n    });\n\n\n    // Previous Step button Click\n    $('.latepoint-booking-form-element .latepoint-prev-btn').on('click', function(e){\n      if($(this).hasClass('disabled') || $(this).hasClass('os-loading')) return false;\n      var $booking_form = $(this).closest('.latepoint-form');\n      var $booking_form_wrapper = $booking_form.closest('.latepoint-booking-form-element');\n\n      var current_step = $booking_form.find('.latepoint_current_step').val();\n\n      if(current_step == 'locations'){\n        $booking_form_wrapper.find('.latepoint_location_id').val('');\n      }\n      if(current_step == 'agents'){\n        $booking_form_wrapper.find('.latepoint_agent_id').val('');\n      }\n      if(current_step == 'payment'){\n        var $payment_step = $booking_form_wrapper.find('.step-payment-w');\n        if($payment_step.length){\n          $payment_step.find('.lp-option.selected').removeClass('selected');\n          var current_payment_step_class = $payment_step.data('current-payment-step');\n          var new_current_payment_step_class = $payment_step.data('prev-payment-step');\n          if(new_current_payment_step_class){\n            var new_prev_payment_step_class = latepoint_get_new_prev_payment_class($payment_step, new_current_payment_step_class);\n            $payment_step.removeClass(current_payment_step_class)\n                        .addClass(new_current_payment_step_class)\n                        .data('current-payment-step', new_current_payment_step_class)\n                        .data('prev-payment-step', new_prev_payment_step_class);\n            hide_next_btn($booking_form_wrapper);\n            return false;\n          }\n        }\n      }\n      if(current_step == 'services'){\n        var $services_step = $booking_form_wrapper.find('.step-services-w');\n        if($services_step.hasClass('selecting-service-duration')){\n          $services_step.removeClass('selecting-service-duration');\n          $services_step.find('.os-services > .os-item.selected').removeClass('selected');\n          return false;\n        }\n        if($services_step.hasClass('selecting-total-attendies')){\n          $services_step.removeClass('selecting-total-attendies');\n          $services_step.find('.os-services > .os-item.selected').removeClass('selected');\n          return false;\n        }\n        if($services_step.hasClass('selecting-service-category')){\n          if($services_step.find('.os-service-category-w .os-service-category-w.selected').length){\n            $services_step.find('.os-service-category-w .os-service-category-w.selected').parents('.os-service-category-w').addClass('selected').find('.os-service-category-w.selected').removeClass('selected');\n          }else{\n            $services_step.removeClass('selecting-service-category').find('.os-service-category-w.selected').removeClass('selected');\n            $services_step.removeClass('selecting-service-category').find('.os-service-categories-holder.show-selected-only').removeClass('show-selected-only');\n          }\n          return false;\n        }\n        $booking_form_wrapper.find('.latepoint_service_id').val('');\n        $booking_form_wrapper.find('input[name=\"booking[duration]\"]').val('');\n        $booking_form_wrapper.find('input[name=\"booking[total_attendies]\"]').val('');\n      }\n\n      latepoint_clear_step_vars($booking_form.find('.latepoint_current_step').val(), $booking_form);\n      $booking_form.find('.latepoint_step_direction').val('prev');\n      $booking_form.submit();\n      $booking_form.closest('.latepoint-with-summary').addClass('latepoint-summary-is-open');\n      $(this).addClass('os-loading');\n      return false;\n    });\n  }\n\n  // DOCUMENT READY\n  $( function() {\n\n    latepoint_init_customer_dashboard_login();\n\n    if($('.latepoint-booking-form-element').length){\n      latepoint_init_booking_form();\n      $('.latepoint-booking-form-element').each(function(){\n        latepoint_init_step($(this).find('.latepoint_current_step').val());\n      });\n    }\n\n    $('.latepoint-request-booking-cancellation').on('click', function(){\n      if(!confirm(latepoint_helper.cancel_booking_prompt)) return false;\n      var $this = $(this);\n      var $booking_box = $this.closest('.customer-booking');\n\n      var route = $(this).data('route');\n      var params = {id: $booking_box.data('id')};\n\n      var data = { action: 'latepoint_route_call', route_name: route, params: params, layout: 'none', return_format: 'json' }\n      $this.addClass('os-loading');\n      $.ajax({\n        type : \"post\",\n        dataType : \"json\",\n        url : latepoint_helper.ajaxurl,\n        data : data,\n        success: function(data){\n          if(data.status === \"success\"){\n            location.reload();\n          }else{\n            $this.removeClass('os-loading');\n          }\n        }\n      });\n      return false;\n    });\n\n\n    $('body').on('click', '.os-step-tabs .os-step-tab', function(){\n      $(this).closest('.os-step-tabs').find('.os-step-tab').removeClass('active');\n      $(this).addClass('active');\n      var target = $(this).data('target');\n      $(this).closest('.os-step-tabs-w').find('.os-step-tab-content').hide();\n      $(target).show();\n    });\n\n    $('body').on('keyup', '.os-form-group .os-form-control', function(){\n      if($(this).val()){\n        $(this).closest('.os-form-group').addClass('has-value');\n      }else{\n        $(this).closest('.os-form-group').removeClass('has-value');\n      }\n    });\n\n    $('.latepoint-tab-triggers').on('click', '.latepoint-tab-trigger', function(){\n      var $tabs_wrapper = $(this).closest('.latepoint-tabs-w')\n      $tabs_wrapper.find('.latepoint-tab-trigger.active').removeClass('active');\n      $tabs_wrapper.find('.latepoint-tab-content').removeClass('active');\n      $(this).addClass('active');\n      $tabs_wrapper.find('.latepoint-tab-content' + $(this).data('tab-target')).addClass('active');\n      return false;\n    });\n\n\n    // Main Button to trigger lightbox opening\n    $('.latepoint-book-button, .os_trigger_booking').on('click', function(){\n      var $this = $(this);\n      var route = latepoint_helper.booking_button_route;\n      var params = {};\n      var restrictions = {};\n      if($this.data('show-service-categories')) restrictions.show_service_categories = $this.data('show-service-categories');\n      if($this.data('show-locations')) restrictions.show_locations = $this.data('show-locations');\n      if($this.data('show-services')) restrictions.show_services = $this.data('show-services');\n      if($this.data('show-agents')) restrictions.show_agents = $this.data('show-agents');\n      if($this.data('selected-location')) restrictions.selected_location = $this.data('selected-location');\n      if($this.data('selected-agent')) restrictions.selected_agent = $this.data('selected-agent');\n      if($this.data('selected-service')) restrictions.selected_service = $this.data('selected-service');\n      if($this.data('selected-service-category')) restrictions.selected_service_category = $this.data('selected-service-category');\n      if($this.data('calendar-start-date')) restrictions.calendar_start_date = $this.data('calendar-start-date');\n\n      if($.isEmptyObject(restrictions) == false) params.restrictions = restrictions;\n\n      var data = { action: 'latepoint_route_call', route_name: route, params: params, layout: 'none', return_format: 'json' }\n      $this.addClass('os-loading');\n      $.ajax({\n        type : \"post\",\n        dataType : \"json\",\n        url : latepoint_helper.ajaxurl,\n        data : data,\n        success: function(data){\n          if(data.status === \"success\"){\n            var lightbox_class = '';\n            if($this.data('hide-summary') != 'yes') lightbox_class+= ' latepoint-with-summary';\n            if($this.data('hide-side-panel') == 'yes') lightbox_class+= ' latepoint-hide-side-panel';\n            latepoint_show_data_in_lightbox(data.message, lightbox_class);\n            latepoint_init_booking_form();\n            latepoint_init_step(data.step);\n            $('body').addClass('latepoint-lightbox-active');\n            $this.removeClass('os-loading');\n            \n          }else{\n            $this.removeClass('os-loading');\n            // console.log(data.message);\n          }\n        }\n      });\n\n      return false;\n    });\n\n\n\n  });\n\n\n} )( jQuery );\n","class OsPaymentsBraintree {\n\n\n  static create_paypal_button(button){\n  \tlet $booking_form_wrapper = jQuery(button).closest('.latepoint-booking-form-element');\n  \tvar payment_amount = latepoint_get_paypal_payment_amount($booking_form_wrapper);\n  \t\n    braintree.client.create({\n      authorization: latepoint_helper.braintree_paypal_client_auth\n    }).then(function (clientInstance) {\n      // Create a PayPal Checkout component.\n      return braintree.paypalCheckout.create({\n        client: clientInstance\n      });\n    }).then(function (paypalCheckoutInstance) {\n      // Set up PayPal with the checkout.js library\n      return paypal.Button.render({\n      \tstyle: {\n      \t\tlabel: 'pay',\n      \t\tsize: 'large',\n      \t\tshape:   'rect',\n      \t\ttagline: false,\n      \t\tcolor: 'gold'\n      \t},\n        env: latepoint_helper.braintree_paypal_environment_name, // or 'sandbox'\n\n        payment: function () {\n          return paypalCheckoutInstance.createPayment({\n            flow: 'checkout', // Required\n            amount: payment_amount, // Required\n            currency: latepoint_helper.paypal_payment_currency,\n            intent: 'authorize' // Required\n            // Your PayPal options here. For available options, see\n            // http://braintree.github.io/braintree-web/current/PayPalCheckout.html#createPayment\n          });\n        },\n\n\n        onAuthorize: function (data, actions) {\n          return paypalCheckoutInstance.tokenizePayment(data)\n            .then(function (payload) {\n\t\t\t        latepoint_set_payment_token_and_submit($booking_form_wrapper, payload.nonce);\n            });\n        },\n\n        onCancel: function (data) {\n          // console.log('checkout.js payment cancelled', JSON.stringify(data, 0, 2));\n        },\n\n        onError: function (err) {\n          console.error('checkout.js error', err);\n        }\n      }, button);\n    }).then(function () {\n      // The PayPal button will be rendered in an html element with the id\n      // `paypal-button`. This function will be called when the PayPal button\n      // is set up and ready to be used.\n    }).catch(function (err) {\n      console.error('Error!', err);\n      // Handle component creation error\n    });\n  }\n\n\tstatic create_token($booking_form_wrapper){\n\t  // Gather additional customer data we may have collected in our form.\n\t  var name = jQuery($booking_form_wrapper).find('#payment_name_on_card');\n\t  var zip = jQuery($booking_form_wrapper).find('#payment_zip');\n\t  var additionalData = {\n\t    name: name ? name.value : undefined,\n\t    address_zip: zip ? zip.value : undefined,\n\t  };\n\n\t  OsPaymentsBraintree.hostedFieldsInstance.tokenize(function (tokenizeErr, payload) {\n\t    if (tokenizeErr) {\n\t    \tif(tokenizeErr.code == 'HOSTED_FIELDS_FIELDS_INVALID' && tokenizeErr.details.invalidFields){\n\t    \t\tjQuery.each(tokenizeErr.details.invalidFields, function(key, field){\n\t    \t\t\tjQuery(field).addClass('braintree-hosted-fields-invalid');\n\t    \t\t});\n\t    \t}\n\t      latepoint_show_message_inside_element(tokenizeErr.message);\n\t      jQuery($booking_form_wrapper).find('.latepoint-next-btn').removeClass('os-loading');\n\t    }else{\n\t      // If we received a token, show the token ID.\n        latepoint_set_payment_token_and_submit($booking_form_wrapper, payload.nonce);\n\t    }\n\t  });\n\t}\n\n\n\n\n\tstatic init_cc_form(){\n\t\tbraintree.client.create({\n\t\t  authorization: latepoint_helper.braintree_tokenization_key\n\t\t}, function(err, clientInstance) {\n\t\t  if (err) {\n\t\t    console.error(err);\n\t\t    return;\n\t\t  }\n\n\t\t  braintree.hostedFields.create({\n\t\t    client: clientInstance,\n\t\t    styles: {\n\t\t      'input': {\n\t\t        'font-size': '14px',\n\t\t        'font-family': latepoint_helper.body_font_family,\n\t\t        'font-weight': '500',\n\t\t        'color': '#fff',\n\t\t      },\n\t\t      ':focus': {\n\t\t        'color': '#fff'\n\t\t      },\n\t\t      '::placeholder': {\n\t\t        'color': '#7d89b1'\n\t\t      },\n\t\t      '.valid': {\n\t\t        'color': '#fff'\n\t\t      },\n\t\t      '.invalid': {\n\t\t        'color': '#ff5a16'\n\t\t      }\n\t\t    },\n\t\t    fields: {\n\t\t      number: {\n\t\t        selector: '#payment_card_number',\n\t\t        placeholder: jQuery('#payment_card_number').data('placeholder')\n\t\t      },\n\t\t      cvv: {\n\t\t        selector: '#payment_card_cvc',\n\t\t        placeholder: jQuery('#payment_card_cvc').data('placeholder')\n\t\t      },\n\t\t      expirationDate: {\n\t\t        selector: '#payment_card_expiration',\n\t\t        placeholder: jQuery('#payment_card_expiration').data('placeholder')\n\t\t      },\n\t\t    }\n\t\t  }, function(err, hostedFieldsInstance) {\n\t\t  \tOsPaymentsBraintree.hostedFieldsInstance = hostedFieldsInstance;\n\t\t    if (err) {\n\t\t      console.error(err);\n\t\t      return;\n\t\t    }\n\t\t  });\n\t\t});\n\t}\n}","class OsPaymentsPaypal {\n\n\n  static create_paypal_button(button){\n  \tlet $booking_form_wrapper = jQuery(button).closest('.latepoint-booking-form-element');\n  \tvar payment_amount = latepoint_get_paypal_payment_amount($booking_form_wrapper);\n\n\t  paypal.Buttons({\n\t    createOrder: function(data, actions) {\n\t      return actions.order.create({\n\t        purchase_units: [{\n\t          amount: {\n\t            value: payment_amount,\n\t            currency_code: latepoint_helper.paypal_payment_currency,\n\t          },\n\t        }],\n\t        application_context: {\n\t\t        shipping_preference: 'NO_SHIPPING'\n\t        }\n\t      });\n\t    },\n\t    onApprove: function(data, actions) {\n\n\t\t\t\tjQuery($booking_form_wrapper).removeClass('step-content-loaded').addClass('step-content-loading');\n\t      // Authorize the transaction\n\t      actions.order.authorize().then(function(authorization) {\n\n\t        // Get the authorization id\n\t        var authorizationID = authorization.purchase_units[0].payments.authorizations[0].id\n          var orderID = data.orderID;\n\t        latepoint_set_payment_token_and_submit($booking_form_wrapper, authorizationID);\n\t      });\n\t    }\n\t  }).render(button);\n  }\n}"]}